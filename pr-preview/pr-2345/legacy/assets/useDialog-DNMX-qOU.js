import{R as d,r as o}from"./index-ClcD9ViR.js";import{h as f}from"./index-Cho7bklK.js";import{c as s,b as $}from"./chain-zZtnTS2i.js";import{g as u,c as m}from"./useFocusable-NpJIjJzn.js";import{$ as p}from"./useEffectEvent-23OTMzEQ.js";const c=d.createContext(null);function b(t){let{children:e}=t,a=o.useContext(c),[r,n]=o.useState(0),l=o.useMemo(()=>({parent:a,modalCount:r,addModal(){n(i=>i+1),a&&a.addModal()},removeModal(){n(i=>i-1),a&&a.removeModal()}}),[a,r]);return d.createElement(c.Provider,{value:l},e)}function x(){let t=o.useContext(c);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function v(t){let{modalProviderProps:e}=x();return d.createElement("div",{"data-overlay-container":!0,...t,...e})}function C(t){return d.createElement(b,null,d.createElement(v,t))}function R(t){let e=s(),{portalContainer:a=e?null:document.body,...r}=t;if(d.useEffect(()=>{if(a!=null&&a.closest("[data-overlay-container]"))throw new Error("An OverlayContainer must not be inside another container. Please change the portalContainer prop.")},[a]),!a)return null;let n=d.createElement(C,r);return f.createPortal(n,a)}function O(t){let e=o.useContext(c);if(!e)throw new Error("Modal is not contained within a provider");return o.useEffect(()=>{if(!(!e||!e.parent))return e.parent.addModal(),()=>{e&&e.parent&&e.parent.removeModal()}},[e,e.parent,void 0]),{modalProps:{"data-ismodal":!0}}}const E=d.createContext(null);function P(){let t=o.useContext(E),e=t==null?void 0:t.setContain;p(()=>{e==null||e(!0)},[e])}function S(t,e){let{role:a="dialog"}=t,r=$();r=t["aria-label"]?void 0:r;let n=o.useRef(!1);return o.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){u(e.current);let l=setTimeout(()=>{document.activeElement===e.current&&(n.current=!0,e.current&&(e.current.blur(),u(e.current)),n.current=!1)},500);return()=>{clearTimeout(l)}}},[e]),P(),{dialogProps:{...m(t,{labelable:!0}),role:a,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||r,onBlur:l=>{n.current&&l.stopPropagation()}},titleProps:{id:r}}}export{C as $,R as a,O as b,S as c};
