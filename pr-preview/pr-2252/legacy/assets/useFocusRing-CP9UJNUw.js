import{r as c}from"./index-v7USjxUg.js";import{$ as A,a as K}from"./useEffectEvent-BaECT7_f.js";const g=e=>{var n;return(n=e==null?void 0:e.ownerDocument)!==null&&n!==void 0?n:document},b=e=>e&&"window"in e&&e.window===e?e:g(e).defaultView||window;function m(e){var n;return typeof window>"u"||window.navigator==null?!1:((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.brands.some(t=>e.test(t.brand)))||e.test(window.navigator.userAgent)}function T(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function l(e){let n=null;return()=>(n==null&&(n=e()),n)}const x=l(function(){return T(/^Mac/i)}),V=l(function(){return T(/^iPhone/i)}),O=l(function(){return T(/^iPad/i)||x()&&navigator.maxTouchPoints>1}),_=l(function(){return V()||O()}),te=l(function(){return x()||_()}),ne=l(function(){return m(/AppleWebKit/i)&&!j()}),j=l(function(){return m(/Chrome/i)}),k=l(function(){return m(/Android/i)}),re=l(function(){return m(/Firefox/i)});function R(e){return e.mozInputSource===0&&e.isTrusted?!0:k()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function oe(e){return!k()&&e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"}class U{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(n,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=n}}function M(e){let n=c.useRef({isFocused:!1,observer:null});A(()=>{const r=n.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=K(r=>{e==null||e(r)});return c.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){n.current.isFocused=!0;let o=r.target,u=a=>{n.current.isFocused=!1,o.disabled&&t(new U("blur",a)),n.current.observer&&(n.current.observer.disconnect(),n.current.observer=null)};o.addEventListener("focusout",u,{once:!0}),n.current.observer=new MutationObserver(()=>{if(n.current.isFocused&&o.disabled){var a;(a=n.current.observer)===null||a===void 0||a.disconnect();let f=o===document.activeElement?null:document.activeElement;o.dispatchEvent(new FocusEvent("blur",{relatedTarget:f})),o.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:f}))}}),n.current.observer.observe(o,{attributes:!0,attributeFilter:["disabled"]})}},[t])}function q(e){let{isDisabled:n,onFocus:t,onBlur:r,onFocusChange:o}=e;const u=c.useCallback(i=>{if(i.target===i.currentTarget)return r&&r(i),o&&o(!1),!0},[r,o]),a=M(u),f=c.useCallback(i=>{const s=g(i.target);i.target===i.currentTarget&&s.activeElement===i.target&&(t&&t(i),o&&o(!0),a(i))},[o,t,a]);return{focusProps:{onFocus:!n&&(t||o||r)?f:void 0,onBlur:!n&&(r||o)?u:void 0}}}let p=null,F=new Set,v=new Map,$=!1,y=!1;const z={Tab:!0,Escape:!0};function E(e,n){for(let t of F)t(e,n)}function G(e){return!(e.metaKey||!x()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function w(e){$=!0,G(e)&&(p="keyboard",E("keyboard",e))}function d(e){p="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&($=!0,E("pointer",e))}function C(e){R(e)&&($=!0,p="virtual")}function W(e){e.target===window||e.target===document||(!$&&!y&&(p="virtual",E("virtual",e)),$=!1,y=!1)}function D(){$=!1,y=!0}function L(e){if(typeof window>"u"||v.get(b(e)))return;const n=b(e),t=g(e);let r=n.HTMLElement.prototype.focus;n.HTMLElement.prototype.focus=function(){$=!0,r.apply(this,arguments)},t.addEventListener("keydown",w,!0),t.addEventListener("keyup",w,!0),t.addEventListener("click",C,!0),n.addEventListener("focus",W,!0),n.addEventListener("blur",D,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",d,!0),t.addEventListener("pointermove",d,!0),t.addEventListener("pointerup",d,!0)):(t.addEventListener("mousedown",d,!0),t.addEventListener("mousemove",d,!0),t.addEventListener("mouseup",d,!0)),n.addEventListener("beforeunload",()=>{H(e)},{once:!0}),v.set(n,{focus:r})}const H=(e,n)=>{const t=b(e),r=g(e);n&&r.removeEventListener("DOMContentLoaded",n),v.has(t)&&(t.HTMLElement.prototype.focus=v.get(t).focus,r.removeEventListener("keydown",w,!0),r.removeEventListener("keyup",w,!0),r.removeEventListener("click",C,!0),t.removeEventListener("focus",W,!0),t.removeEventListener("blur",D,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",d,!0),r.removeEventListener("pointermove",d,!0),r.removeEventListener("pointerup",d,!0)):(r.removeEventListener("mousedown",d,!0),r.removeEventListener("mousemove",d,!0),r.removeEventListener("mouseup",d,!0)),v.delete(t))};function N(e){const n=g(e);let t;return n.readyState!=="loading"?L(e):(t=()=>{L(e)},n.addEventListener("DOMContentLoaded",t)),()=>H(e,t)}typeof document<"u"&&N();function S(){return p!=="pointer"}function ue(){return p}function ae(e){p=e,E(e,null)}const Y=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function J(e,n,t){var r;const o=typeof window<"u"?b(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,u=typeof window<"u"?b(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,a=typeof window<"u"?b(t==null?void 0:t.target).HTMLElement:HTMLElement,f=typeof window<"u"?b(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return e=e||(t==null?void 0:t.target)instanceof o&&!Y.has(t==null||(r=t.target)===null||r===void 0?void 0:r.type)||(t==null?void 0:t.target)instanceof u||(t==null?void 0:t.target)instanceof a&&(t==null?void 0:t.target.isContentEditable),!(e&&n==="keyboard"&&t instanceof f&&!z[t.key])}function Q(e,n,t){L(),c.useEffect(()=>{let r=(o,u)=>{J(!!(t!=null&&t.isTextInput),o,u)&&e(S())};return F.add(r),()=>{F.delete(r)}},n)}function X(e){let{isDisabled:n,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:o}=e,u=c.useRef({isFocusWithin:!1}),a=c.useCallback(s=>{u.current.isFocusWithin&&!s.currentTarget.contains(s.relatedTarget)&&(u.current.isFocusWithin=!1,t&&t(s),o&&o(!1))},[t,o,u]),f=M(a),i=c.useCallback(s=>{!u.current.isFocusWithin&&document.activeElement===s.target&&(r&&r(s),o&&o(!0),u.current.isFocusWithin=!0,f(s))},[r,o,f]);return n?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:i,onBlur:a}}}function ie(e={}){let{autoFocus:n=!1,isTextInput:t,within:r}=e,o=c.useRef({isFocused:!1,isFocusVisible:n||S()}),[u,a]=c.useState(!1),[f,i]=c.useState(()=>o.current.isFocused&&o.current.isFocusVisible),s=c.useCallback(()=>i(o.current.isFocused&&o.current.isFocusVisible),[]),P=c.useCallback(h=>{o.current.isFocused=h,a(h),s()},[s]);Q(h=>{o.current.isFocusVisible=h,s()},[],{isTextInput:t});let{focusProps:I}=q({isDisabled:r,onFocusChange:P}),{focusWithinProps:B}=X({isDisabled:!r,onFocusWithinChange:P});return{isFocused:u,isFocusVisible:f,focusProps:r?B:I}}export{ie as $,X as a,b,g as c,k as d,j as e,ue as f,ae as g,S as h,q as i,_ as j,ne as k,x as l,te as m,re as n,O as o,oe as p,R as q};
