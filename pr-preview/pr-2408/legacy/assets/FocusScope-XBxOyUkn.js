import{a as z}from"./chain-ClNFszml.js";import{s as U,e as y,n as m,l as $,t as x,u as J,v as j,q as B,w as H,p as G}from"./useFocusRing-C3R0V8mE.js";import{$ as T}from"./useLayoutEffect--7U9ZmH-.js";import{h as V}from"./usePopper-BYrUHtW_.js";import{r as p,a as _}from"./iframe-DLd4WZJZ.js";class Q{get currentNode(){return this._currentNode}set currentNode(e){if(!y(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const t=[];let o=e,n=e;for(this._currentNode=e;o&&o!==this.root;)if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const l=o,a=this._doc.createTreeWalker(l,this.whatToShow,{acceptNode:this._acceptNode});t.push(a),a.currentNode=n,this._currentSetFor.add(a),o=n=l.host}else o=o.parentNode;const i=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});t.push(i),i.currentNode=n,this._currentSetFor.add(i),this._walkerStack=t}get doc(){return this._doc}firstChild(){let e=this.currentNode,t=this.nextNode();return y(e,t)?(t&&(this.currentNode=t),t):(this.currentNode=e,null)}lastChild(){let t=this._walkerStack[0].lastChild();return t&&(this.currentNode=t),t}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var t;let n;if(typeof this.filter=="function"?n=this.filter(e):!((t=this.filter)===null||t===void 0)&&t.acceptNode&&(n=this.filter.acceptNode(e)),n===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let i=this.nextNode();return i&&(this.currentNode=i),i}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let o=this.nextNode();return o&&(this.currentNode=o),o}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let n=this.previousNode();return n&&(this.currentNode=n),n}else return null;return null}const t=e.previousNode();if(t){if(t.shadowRoot){var o;let i;if(typeof this.filter=="function"?i=this.filter(t):!((o=this.filter)===null||o===void 0)&&o.acceptNode&&(i=this.filter.acceptNode(t)),i===NodeFilter.FILTER_ACCEPT)return t&&(this.currentNode=t),t;let l=this.lastChild();return l&&(this.currentNode=l),l}return t&&(this.currentNode=t),t}else if(this._walkerStack.length>1){this._walkerStack.shift();let n=this.previousNode();return n&&(this.currentNode=n),n}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,t,o,n){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=l=>{if(l.nodeType===Node.ELEMENT_NODE){const v=l.shadowRoot;if(v){const u=this._doc.createTreeWalker(v,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(u),NodeFilter.FILTER_ACCEPT}else{var a;if(typeof this.filter=="function")return this.filter(l);if(!((a=this.filter)===null||a===void 0)&&a.acceptNode)return this.filter.acceptNode(l);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=t,this.filter=n??null,this.whatToShow=o??NodeFilter.SHOW_ALL,this._currentNode=t,this._walkerStack.unshift(e.createTreeWalker(t,o,this._acceptNode));const i=t.shadowRoot;if(i){const l=this._doc.createTreeWalker(i,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(l)}}}function X(r,e,t,o){return U()?new Q(r,e,t,o):r.createTreeWalker(e,t,o)}function de(r,e){let{id:t,"aria-label":o,"aria-labelledby":n}=r;return t=z(t),n&&o?n=[...new Set([t,...n.trim().split(/\s+/)])].join(" "):n&&(n=n.trim().split(/\s+/).join(" ")),!o&&!n&&e&&(o=e),{id:t,"aria-label":o,"aria-labelledby":n}}const D=_.createContext(null),M="react-aria-focus-scope-restore";let f=null;function ce(r){let{children:e,contain:t,restoreFocus:o,autoFocus:n}=r,i=p.useRef(null),l=p.useRef(null),a=p.useRef([]),{parentNode:v}=p.useContext(D)||{},u=p.useMemo(()=>new A({scopeRef:a}),[a]);T(()=>{let c=v||b.root;if(b.getTreeNode(c.scopeRef)&&f&&!C(f,c.scopeRef)){let s=b.getTreeNode(f);s&&(c=s)}c.addChild(u),b.addNode(u)},[u,v]),T(()=>{let c=b.getTreeNode(a);c&&(c.contain=!!t)},[t]),T(()=>{var c;let s=(c=i.current)===null||c===void 0?void 0:c.nextSibling,N=[],R=L=>L.stopPropagation();for(;s&&s!==l.current;)N.push(s),s.addEventListener(M,R),s=s.nextSibling;return a.current=N,()=>{for(let L of N)L.removeEventListener(M,R)}},[e]),re(a,o,t),ee(a,t),ne(a,o,t),te(a,n),p.useEffect(()=>{const c=m($(a.current?a.current[0]:void 0));let s=null;if(E(c,a.current)){for(let N of b.traverse())N.scopeRef&&E(c,N.scopeRef.current)&&(s=N);s===b.getTreeNode(a)&&(f=s.scopeRef)}},[a]),T(()=>()=>{var c,s,N;let R=(N=(s=b.getTreeNode(a))===null||s===void 0||(c=s.parent)===null||c===void 0?void 0:c.scopeRef)!==null&&N!==void 0?N:null;(a===f||C(a,f))&&(!R||b.getTreeNode(R))&&(f=R),b.removeTreeNode(a)},[a]);let h=p.useMemo(()=>Y(a),[]),d=p.useMemo(()=>({focusManager:h,parentNode:u}),[u,h]);return _.createElement(D.Provider,{value:d},_.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:i}),e,_.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:l}))}function Y(r){return{focusNext(e={}){let t=r.current,{from:o,tabbable:n,wrap:i,accept:l}=e;var a;let v=o||m($((a=t[0])!==null&&a!==void 0?a:void 0)),u=t[0].previousElementSibling,h=S(t),d=g(h,{tabbable:n,accept:l},t);d.currentNode=E(v,t)?v:u;let c=d.nextNode();return!c&&i&&(d.currentNode=u,c=d.nextNode()),c&&w(c,!0),c},focusPrevious(e={}){let t=r.current,{from:o,tabbable:n,wrap:i,accept:l}=e;var a;let v=o||m($((a=t[0])!==null&&a!==void 0?a:void 0)),u=t[t.length-1].nextElementSibling,h=S(t),d=g(h,{tabbable:n,accept:l},t);d.currentNode=E(v,t)?v:u;let c=d.previousNode();return!c&&i&&(d.currentNode=u,c=d.previousNode()),c&&w(c,!0),c},focusFirst(e={}){let t=r.current,{tabbable:o,accept:n}=e,i=S(t),l=g(i,{tabbable:o,accept:n},t);l.currentNode=t[0].previousElementSibling;let a=l.nextNode();return a&&w(a,!0),a},focusLast(e={}){let t=r.current,{tabbable:o,accept:n}=e,i=S(t),l=g(i,{tabbable:o,accept:n},t);l.currentNode=t[t.length-1].nextElementSibling;let a=l.previousNode();return a&&w(a,!0),a}}}function S(r){return r[0].parentElement}function F(r){let e=b.getTreeNode(f);for(;e&&e.scopeRef!==r;){if(e.contain)return!1;e=e.parent}return!0}function Z(r){if(r.checked)return!0;let e=[];if(!r.form)e=[...$(r).querySelectorAll(`input[type="radio"][name="${CSS.escape(r.name)}"]`)].filter(i=>!i.form);else{var t,o;let i=(o=r.form)===null||o===void 0||(t=o.elements)===null||t===void 0?void 0:t.namedItem(r.name);e=[...i??[]]}return e?!e.some(i=>i.checked):!1}function ee(r,e){let t=p.useRef(void 0),o=p.useRef(void 0);T(()=>{let n=r.current;if(!e){o.current&&(cancelAnimationFrame(o.current),o.current=void 0);return}const i=$(n?n[0]:void 0);let l=u=>{if(u.key!=="Tab"||u.altKey||u.ctrlKey||u.metaKey||!F(r)||u.isComposing)return;let h=m(i),d=r.current;if(!d||!E(h,d))return;let c=S(d),s=g(c,{tabbable:!0},d);if(!h)return;s.currentNode=h;let N=u.shiftKey?s.previousNode():s.nextNode();N||(s.currentNode=u.shiftKey?d[d.length-1].nextElementSibling:d[0].previousElementSibling,N=u.shiftKey?s.previousNode():s.nextNode()),u.preventDefault(),N&&w(N,!0)},a=u=>{(!f||C(f,r))&&E(x(u),r.current)?(f=r,t.current=x(u)):F(r)&&!k(x(u),r)?t.current?t.current.focus():f&&f.current&&I(f.current):F(r)&&(t.current=x(u))},v=u=>{o.current&&cancelAnimationFrame(o.current),o.current=requestAnimationFrame(()=>{let h=G(),d=(h==="virtual"||h===null)&&J()&&j(),c=m(i);if(!d&&c&&F(r)&&!k(c,r)){f=r;let N=x(u);if(N&&N.isConnected){var s;t.current=N,(s=t.current)===null||s===void 0||s.focus()}else f.current&&I(f.current)}})};return i.addEventListener("keydown",l,!1),i.addEventListener("focusin",a,!1),n==null||n.forEach(u=>u.addEventListener("focusin",a,!1)),n==null||n.forEach(u=>u.addEventListener("focusout",v,!1)),()=>{i.removeEventListener("keydown",l,!1),i.removeEventListener("focusin",a,!1),n==null||n.forEach(u=>u.removeEventListener("focusin",a,!1)),n==null||n.forEach(u=>u.removeEventListener("focusout",v,!1))}},[r,e]),T(()=>()=>{o.current&&cancelAnimationFrame(o.current)},[o])}function O(r){return k(r)}function E(r,e){return!r||!e?!1:e.some(t=>y(t,r))}function k(r,e=null){if(r instanceof Element&&r.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:t}of b.traverse(b.getTreeNode(e)))if(t&&E(r,t.current))return!0;return!1}function se(r){return k(r,f)}function C(r,e){var t;let o=(t=b.getTreeNode(e))===null||t===void 0?void 0:t.parent;for(;o;){if(o.scopeRef===r)return!0;o=o.parent}return!1}function w(r,e=!1){if(r!=null&&!e)try{V(r)}catch{}else if(r!=null)try{r.focus()}catch{}}function q(r,e=!0){let t=r[0].previousElementSibling,o=S(r),n=g(o,{tabbable:e},r);n.currentNode=t;let i=n.nextNode();return e&&!i&&(o=S(r),n=g(o,{tabbable:!1},r),n.currentNode=t,i=n.nextNode()),i}function I(r,e=!0){w(q(r,e))}function te(r,e){const t=_.useRef(e);p.useEffect(()=>{if(t.current){f=r;const o=$(r.current?r.current[0]:void 0);!E(m(o),f.current)&&r.current&&I(r.current)}t.current=!1},[r])}function re(r,e,t){T(()=>{if(e||t)return;let o=r.current;const n=$(o?o[0]:void 0);let i=l=>{let a=x(l);E(a,r.current)?f=r:O(a)||(f=null)};return n.addEventListener("focusin",i,!1),o==null||o.forEach(l=>l.addEventListener("focusin",i,!1)),()=>{n.removeEventListener("focusin",i,!1),o==null||o.forEach(l=>l.removeEventListener("focusin",i,!1))}},[r,e,t])}function P(r){let e=b.getTreeNode(f);for(;e&&e.scopeRef!==r;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===r}function ne(r,e,t){const o=p.useRef(typeof document<"u"?m($(r.current?r.current[0]:void 0)):null);T(()=>{let n=r.current;const i=$(n?n[0]:void 0);if(!e||t)return;let l=()=>{(!f||C(f,r))&&E(m(i),r.current)&&(f=r)};return i.addEventListener("focusin",l,!1),n==null||n.forEach(a=>a.addEventListener("focusin",l,!1)),()=>{i.removeEventListener("focusin",l,!1),n==null||n.forEach(a=>a.removeEventListener("focusin",l,!1))}},[r,t]),T(()=>{const n=$(r.current?r.current[0]:void 0);if(!e)return;let i=l=>{if(l.key!=="Tab"||l.altKey||l.ctrlKey||l.metaKey||!F(r)||l.isComposing)return;let a=n.activeElement;if(!k(a,r)||!P(r))return;let v=b.getTreeNode(r);if(!v)return;let u=v.nodeToRestore,h=g(n.body,{tabbable:!0});h.currentNode=a;let d=l.shiftKey?h.previousNode():h.nextNode();if((!u||!u.isConnected||u===n.body)&&(u=void 0,v.nodeToRestore=void 0),(!d||!k(d,r))&&u){h.currentNode=u;do d=l.shiftKey?h.previousNode():h.nextNode();while(k(d,r));l.preventDefault(),l.stopPropagation(),d?w(d,!0):O(u)?w(u,!0):a.blur()}};return t||n.addEventListener("keydown",i,!0),()=>{t||n.removeEventListener("keydown",i,!0)}},[r,e,t]),T(()=>{const n=$(r.current?r.current[0]:void 0);if(!e)return;let i=b.getTreeNode(r);if(i){var l;return i.nodeToRestore=(l=o.current)!==null&&l!==void 0?l:void 0,()=>{let a=b.getTreeNode(r);if(!a)return;let v=a.nodeToRestore,u=m(n);if(e&&v&&(u&&k(u,r)||u===n.body&&P(r))){let h=b.clone();requestAnimationFrame(()=>{if(n.activeElement===n.body){let d=h.getTreeNode(r);for(;d;){if(d.nodeToRestore&&d.nodeToRestore.isConnected){W(d.nodeToRestore);return}d=d.parent}for(d=h.getTreeNode(r);d;){if(d.scopeRef&&d.scopeRef.current&&b.getTreeNode(d.scopeRef)){let c=q(d.scopeRef.current,!0);W(c);return}d=d.parent}}})}}}},[r,e])}function W(r){r.dispatchEvent(new CustomEvent(M,{bubbles:!0,cancelable:!0}))&&w(r)}function g(r,e,t){let o=e!=null&&e.tabbable?B:H,n=(r==null?void 0:r.nodeType)===Node.ELEMENT_NODE?r:null,i=$(n),l=X(i,r||i,NodeFilter.SHOW_ELEMENT,{acceptNode(a){return y(e==null?void 0:e.from,a)||e!=null&&e.tabbable&&a.tagName==="INPUT"&&a.getAttribute("type")==="radio"&&(!Z(a)||l.currentNode.tagName==="INPUT"&&l.currentNode.type==="radio"&&l.currentNode.name===a.name)?NodeFilter.FILTER_REJECT:o(a)&&(!t||E(a,t))&&(!(e!=null&&e.accept)||e.accept(a))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(l.currentNode=e.from),l}class K{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,t,o){let n=this.fastMap.get(t??null);if(!n)return;let i=new A({scopeRef:e});n.addChild(i),i.parent=n,this.fastMap.set(e,i),o&&(i.nodeToRestore=o)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let t=this.fastMap.get(e);if(!t)return;let o=t.parent;for(let i of this.traverse())i!==t&&t.nodeToRestore&&i.nodeToRestore&&t.scopeRef&&t.scopeRef.current&&E(i.nodeToRestore,t.scopeRef.current)&&(i.nodeToRestore=t.nodeToRestore);let n=t.children;o&&(o.removeChild(t),n.size>0&&n.forEach(i=>o&&o.addChild(i))),this.fastMap.delete(t.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let t of e.children)yield*this.traverse(t)}clone(){var e;let t=new K;var o;for(let n of this.traverse())t.addTreeNode(n.scopeRef,(o=(e=n.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&o!==void 0?o:null,n.nodeToRestore);return t}constructor(){this.fastMap=new Map,this.root=new A({scopeRef:null}),this.fastMap.set(null,this.root)}}class A{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}let b=new K;export{ce as $,g as a,se as b,de as c};
