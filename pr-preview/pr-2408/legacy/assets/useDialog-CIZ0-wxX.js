import{r,R as d}from"./index-B2-qRKKC.js";import{I as f}from"./index-CFX93qP1.js";import{c as $,b as s}from"./chain-z5L_5vtA.js";import{g as u,c as m}from"./useFocusable-vWFmc0ol.js";import{$ as b}from"./useEffectEvent-BOE4tD14.js";const p=r.createContext({});function x(){var t;return(t=r.useContext(p))!==null&&t!==void 0?t:{}}const c=d.createContext(null);function v(t){let{children:e}=t,a=r.useContext(c),[o,n]=r.useState(0),l=r.useMemo(()=>({parent:a,modalCount:o,addModal(){n(i=>i+1),a&&a.addModal()},removeModal(){n(i=>i-1),a&&a.removeModal()}}),[a,o]);return d.createElement(c.Provider,{value:l},e)}function C(){let t=r.useContext(c);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function E(t){let{modalProviderProps:e}=C();return d.createElement("div",{"data-overlay-container":!0,...t,...e})}function P(t){return d.createElement(v,null,d.createElement(E,t))}function O(t){let e=$(),{portalContainer:a=e?null:document.body,...o}=t,{getContainer:n}=x();if(!t.portalContainer&&n&&(a=n()),d.useEffect(()=>{if(a!=null&&a.closest("[data-overlay-container]"))throw new Error("An OverlayContainer must not be inside another container. Please change the portalContainer prop.")},[a]),!a)return null;let l=d.createElement(P,o);return f.createPortal(l,a)}function S(t){let e=r.useContext(c);if(!e)throw new Error("Modal is not contained within a provider");return r.useEffect(()=>{if(!(!e||!e.parent))return e.parent.addModal(),()=>{e&&e.parent&&e.parent.removeModal()}},[e,e.parent,void 0]),{modalProps:{"data-ismodal":!0}}}const M=d.createContext(null);function h(){let t=r.useContext(M),e=t==null?void 0:t.setContain;b(()=>{e==null||e(!0)},[e])}function T(t,e){let{role:a="dialog"}=t,o=s();o=t["aria-label"]?void 0:o;let n=r.useRef(!1);return r.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){u(e.current);let l=setTimeout(()=>{(document.activeElement===e.current||document.activeElement===document.body)&&(n.current=!0,e.current&&(e.current.blur(),u(e.current)),n.current=!1)},500);return()=>{clearTimeout(l)}}},[e]),h(),{dialogProps:{...m(t,{labelable:!0}),role:a,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||o,onBlur:l=>{n.current&&l.stopPropagation()}},titleProps:{id:o}}}export{P as $,O as a,S as b,T as c};
