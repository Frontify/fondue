import{e as x,r as w,j as A}from"./iframe-IHwEIfX3.js";import{f as je,h as Le,d as $e,i as _e,a as Fe,A as Be,c as Me,g as Ve,b as Ke,M as Ie,e as Re}from"./getAreaFillColors-DYAlnxJh.js";import{c as Se,_,a as Ge,L as ne,e as Ye}from"./Legend-gEPqUT8F.js";import{W as z,D as J,J as We,K as Xe,N as oe,i as G,j as $,Y as Ue,u as ze,X as He,Z as Ze,y as Je,x as Qe,l as et,P as se,_ as tt,c as rt,d as at,e as nt,T as ot}from"./useMargin-CQnXRfD-.js";import{c as st}from"./createTheme-Dk-lZnlG.js";import{g as it}from"./getChildrenAndGrandchildrenWithProps-CNfmcsc6.js";import{l as ut}from"./D3ShapeFactories-Ch-vNTVa.js";import{G as lt}from"./Group-Co62xcjG.js";import"./preload-helper-DIGkZQWG.js";import"./pie-DtVSWFrF.js";import"./getDataPointValue-CRRm8Vx-.js";import"./TooltipContent-BNyhU1Nf.js";var ct=["children","data","x","y","fill","className","curve","innerRef","defined"];function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},H.apply(this,arguments)}function dt(e,t){if(e==null)return{};var r={},a=Object.keys(e),o,n;for(n=0;n<a.length;n++)o=a[n],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function mt(e){var t=e.children,r=e.data,a=r===void 0?[]:r,o=e.x,n=e.y,i=e.fill,s=i===void 0?"transparent":i,c=e.className,u=e.curve,d=e.innerRef,y=e.defined,S=y===void 0?function(){return!0}:y,f=dt(e,ct),h=ut({x:o,y:n,defined:S,curve:u});return t?x.createElement(x.Fragment,null,t({path:h})):x.createElement("path",H({ref:d,className:Se("visx-linepath",c),d:h(a)||"",fill:s,strokeLinecap:"round"},f))}var R=ft,F=pt;function ft(e){return e==null?void 0:e[0]}function pt(e){return e==null?void 0:e[1]}function Y(e){return function(){return e}}function yt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ie(e,t){if((i=e.length)>1)for(var r=1,a,o,n=e[t[0]],i,s=n.length;r<i;++r)for(o=n,n=e[t[r]],a=0;a<s;++a)n[a][1]+=n[a][0]=isNaN(o[a][1])?o[a][0]:o[a][1]}function ue(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function ht(e,t){return e[t]}function vt(e){const t=[];return t.key=e,t}function gt(){var e=Y([]),t=ue,r=ie,a=ht;function o(n){var i=Array.from(e.apply(this,arguments),vt),s,c=i.length,u=-1,d;for(const y of n)for(s=0,++u;s<c;++s)(i[s][u]=[0,+a(y,i[s].key,u,n)]).data=y;for(s=0,d=yt(t(i));s<c;++s)i[d[s]].index=s;return r(i,d),i}return o.keys=function(n){return arguments.length?(e=typeof n=="function"?n:Y(Array.from(n)),o):e},o.value=function(n){return arguments.length?(a=typeof n=="function"?n:Y(+n),o):a},o.order=function(n){return arguments.length?(t=n==null?ue:typeof n=="function"?n:Y(Array.from(n)),o):t},o.offset=function(n){return arguments.length?(r=n??ie,o):r},o}var le=function(t){var r;return t==null||(r=t.data)==null?void 0:r.stack},ce=function(t){return(R(t)+F(t))/2};function kt(e,t,r){var a=r?[ce,le]:[le,ce],o=a[0],n=a[1];return e.map(function(i,s){var c={key:i.key,data:i,xAccessor:o,yAccessor:n};return t.length>0&&s===0&&(r?c.xScale=function(u){return u.domain(z(u.domain().concat(t)))}:c.yScale=function(u){return u.domain(z(u.domain().concat(t)))}),c}).filter(function(i){return i})}var W=function(t){return t.stack};function St(e,t){var r={};return e.forEach(function(a){var o=a.props,n=o.dataKey,i=o.data,s=o.xAccessor,c=o.yAccessor;if(!(!s||!c)){var u=t?[c,s]:[s,c],d=u[0],y=u[1];i.forEach(function(S){var f=d(S),h=y(S),g=String(f);r[g]||(r[g]={stack:f,positiveSum:0,negativeSum:0}),r[g][n]=h,r[g][h>=0?"positiveSum":"negativeSum"]+=h})}}),Object.values(r)}function xt(e){var t=e.children,r=e.order,a=e.offset,o=w.useContext(J),n=o.horizontal,i=o.registerData,s=o.unregisterData,c=w.useMemo(function(){return it(t)},[t]),u=w.useMemo(function(){return c.filter(function(f){return f.props.dataKey}).map(function(f){return f.props.dataKey})},[c]),d=w.useMemo(function(){return St(c,n)},[n,c]),y=w.useMemo(function(){var f=a?null:d.some(function(g){return g.negativeSum<0}),h=gt();return h.keys(u),r&&h.order(je(r)),(a||f)&&h.offset(Le(a||"diverging")),h(d)},[d,u,r,a]),S=w.useMemo(function(){return z(y.reduce(function(f,h){return h.forEach(function(g){var C=g[0],b=g[1];f.push(C),f.push(b)}),f},[]))},[y]);return w.useEffect(function(){var f=kt(y,S,n);return i(f),function(){return s(u)}},[u,S,n,y,i,s,c]),{seriesChildren:c,dataKeys:u,stackedData:y}}function bt(e,t,r){var a,o,n,i,s=e.xScale,c=e.yScale,u=e.point,d=(r?We:Xe)(e),y=(d==null?void 0:d.index)==null?null:t[d.index];return d&&y&&u?{index:d.index,datum:y,distanceX:r&&u.x>=((a=s(R(d.datum)))!=null?a:1/0)&&u.x<=((o=s(F(d.datum)))!=null?o:-1/0)?0:d.distanceX,distanceY:r?d.distanceY:u.y<=((n=c(R(d.datum)))!=null?n:-1/0)&&u.y>=((i=c(F(d.datum)))!=null?i:1/0)?0:d.distanceY}:null}var Pt=["data","dataKey","xAccessor","yAccessor","curve","PathComponent","lineProps","renderLine"];function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},j.apply(this,arguments)}function At(e,t){if(e==null)return{};var r={},a=Object.keys(e),o,n;for(n=0;n<a.length;n++)o=a[n],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}var de=function(t){return t};function xe(e){var t=e.PathComponent,r=t===void 0?"path":t,a=e.children,o=e.curve,n=e.enableEvents,i=n===void 0?!0:n,s=e.offset,c=e.onBlur,u=e.onFocus,d=e.onPointerMove,y=e.onPointerOut,S=e.onPointerUp,f=e.onPointerDown,h=e.order,g=e.renderLine,C=g===void 0?!0:g,b=w.useContext(J),P=b.colorScale,X=b.dataRegistry,B=b.horizontal,N=b.xScale,T=b.yScale,E=b.theme,L=xt({children:a,order:h,offset:s}),q=L.dataKeys,D=L.seriesChildren,ee=L.stackedData,te=w.useMemo(function(){var l=oe(N)/2,k=oe(T)/2;return B?{y:function(p){var v;return((v=$(T(W(p.data))))!=null?v:0)+k},x0:function(p){var v;return((v=$(N(R(p))))!=null?v:0)+l},x1:function(p){var v;return((v=$(N(F(p))))!=null?v:0)+l},defined:function(p){return G(T(W(p.data)))&&G(N(F(p)))}}:{x:function(p){var v;return((v=$(N(W(p.data))))!=null?v:0)+l},y0:function(p){var v;return((v=$(T(R(p))))!=null?v:0)+k},y1:function(p){var v;return((v=$(T(F(p))))!=null?v:0)+k},defined:function(p){return G(N(W(p.data)))&&G(T(F(p)))}}},[N,T,B]),M=w.useMemo(function(){return ee.map(function(l,k){var m,p,v,ae=D.find(function(qe){return qe.props.dataKey===l.key}),O=(ae==null?void 0:ae.props)||{};O.data,O.dataKey,O.xAccessor,O.yAccessor,O.curve,O.PathComponent;var Ee=O.lineProps;O.renderLine;var De=At(O,Pt),Oe=j({fill:(m=(p=P==null?void 0:P(l.key))!=null?p:E==null||(v=E.colors)==null?void 0:v[0])!=null?m:"#222"},De);return{key:k+"-"+l.key,accessors:te,data:l,areaProps:Oe,lineProps:Ee}})},[ee,te,P,D,E]),Ne=w.useCallback(function(l){var k,m,p=(k=D.find(function(v){return v.props.dataKey===l.dataKey}))==null||(m=k.props)==null?void 0:m.data;return p?bt(l,p,B):null},[D,B]),re=Ue+"-"+q.join("-"),V=ze({dataKey:q,enableEvents:i,findNearestDatum:Ne,onBlur:c,onFocus:u,onPointerMove:d,onPointerOut:y,onPointerUp:S,onPointerDown:f,source:re,allowedSources:[He,re]}),U=!!(u||c),Ce=w.useCallback(function(l){var k=l.glyphs;return U?k.map(function(m){return x.createElement(x.Fragment,{key:m.key},$e(j({},m,{color:"transparent",onFocus:V.onFocus,onBlur:V.onBlur})))}):null},[U,V.onFocus,V.onBlur]);return q.some(function(l){return X.get(l)==null})||!N||!T||!P?null:x.createElement("g",{className:"visx-area-stack"},M.map(function(l){return x.createElement(_e,j({key:l.key,curve:o},l.accessors),function(k){var m=k.path;return x.createElement(r,j({className:"visx-area",stroke:"transparent",d:m(l.data)||""},l.areaProps,V))})}),C&&M.map(function(l){return x.createElement(mt,j({key:"line-"+l.key,x:l.accessors.x||l.accessors.x1,y:l.accessors.y||l.accessors.y1,defined:l.accessors.defined,curve:o},l.lineProps),function(k){var m=k.path;return x.createElement(r,j({className:"visx-line",fill:"transparent",stroke:l.areaProps.fill,strokeWidth:2,pointerEvents:"none"},l.lineProps,{d:m(l.data)||""}))})}),U&&M.map(function(l,k){var m=M[M.length-k-1];return x.createElement(Fe,{key:"glyphs-"+m.key,dataKey:m.key,data:m.data,xAccessor:m.accessors.x||m.accessors.x1,yAccessor:m.accessors.y||m.accessors.y1,xScale:de,yScale:de,renderGlyphs:Ce})}))}xe.propTypes={children:_.oneOfType([_.element,_.arrayOf(_.element)]).isRequired,renderLine:_.bool};function wt(e){return x.createElement(xe,e)}const Tt=e=>{if(!e[0])return 0;let t=0;const r=e[0].dataPoints.length;for(let a=0;a<r;a++){const o=e.reduce((n,i)=>{var s;return n+(((s=i==null?void 0:i.dataPoints[a])==null?void 0:s.value)||0)},0);t=Math.max(t,o)}return t},Nt=(e,t)=>{const r=Tt(e),a=Ze(Math.max(r,t??0)),o=Math.ceil(Math.max(r,t||0)/a)*a;return o===0?[0,1]:[0,o]},Ct=(e,t)=>{const[r,a]=e,o=(a-r)/(t-1);return Array.from({length:t}).map((i,s)=>Math.ceil(s*o))},me=e=>e<1e3?e:e>1e5?Math.ceil(e/(1024*100))*(1024*100):Math.ceil(e/1024)*1024,Et=e=>[me(e[0]),me(e[1])],be=({series:e})=>{const t=[...e].reverse();return A.jsx(wt,{children:t.map((r,a)=>A.jsx(Be,{dataKey:r.name,data:r.dataPoints,xAccessor:Qe,yAccessor:Je,fillOpacity:.2,lineProps:{strokeWidth:2},fill:Ge(t.length-1-a)},r.name))})};be.__docgenInfo={description:"",methods:[],displayName:"AreaStack",props:{series:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    dataPoints: LineChartDataPoint[];
    name: string;
}`,signature:{properties:[{key:"dataPoints",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    timestamp: Date;
    value: number | null;
    description?: string;
    valueContext?: string;
}`,signature:{properties:[{key:"timestamp",value:{name:"Date",required:!0}},{key:"value",value:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}],required:!0}},{key:"description",value:{name:"string",required:!1}},{key:"valueContext",value:{name:"string",required:!1}}]}}],raw:"LineChartDataPoint[]",required:!0}},{key:"name",value:{name:"string",required:!0}}]}}],raw:"LineChartSeries[]"},description:""}}};function Dt(e){return"bandwidth"in e?e.bandwidth():0}var Ot=["top","left","scale","width","stroke","strokeWidth","strokeDasharray","className","children","numTicks","lineStyle","offset","tickValues"];function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Z.apply(this,arguments)}function qt(e,t){if(e==null)return{};var r={},a=Object.keys(e),o,n;for(n=0;n<a.length;n++)o=a[n],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Pe(e){var t=e.top,r=t===void 0?0:t,a=e.left,o=a===void 0?0:a,n=e.scale,i=e.width,s=e.stroke,c=s===void 0?"#eaf0f6":s,u=e.strokeWidth,d=u===void 0?1:u,y=e.strokeDasharray,S=e.className,f=e.children,h=e.numTicks,g=h===void 0?10:h,C=e.lineStyle,b=e.offset,P=e.tickValues,X=qt(e,Ot),B=P??et(n,g),N=(b??0)+Dt(n)/2,T=B.map(function(E,L){var q,D=((q=$(n(E)))!=null?q:0)+N;return{index:L,from:new se({x:0,y:D}),to:new se({x:i,y:D})}});return x.createElement(lt,{className:Se("visx-rows",S),top:r,left:o},f?f({lines:T}):T.map(function(E){var L=E.from,q=E.to,D=E.index;return x.createElement(tt,Z({key:"row-line-"+D,from:L,to:q,stroke:c,strokeWidth:d,strokeDasharray:y,style:C},X))}))}Pe.propTypes={tickValues:_.array,width:_.number.isRequired};const Ae=({tickValues:e})=>{const{yScale:t,innerWidth:r,margin:a}=w.useContext(J);return t?A.jsx(Pe,{left:(a==null?void 0:a.left)||0,width:r||0,scale:t,numTicks:5,tickValues:e}):null};Ae.__docgenInfo={description:"",methods:[],displayName:"GridRows",props:{tickValues:{required:!0,tsType:{name:"Array",elements:[{name:"number"}],raw:"number[]"},description:""}}};const jt=5,Lt="storage",$t="storage",fe="top",Q=({width:e,height:t,series:r,missingValueLabel:a,locale:o,hideLegend:n=!1,legendPosition:i=fe,markLine:s,valueFormatter:c,childSumLabel:u,domain:d=$t})=>{const y=Me(r),S=st(Ve(r.length,y.length)),f=Nt(r,(s==null?void 0:s.value)??0),h=d===Lt?Et(f):f,g=rt(h,jt),C=Ct(h,g.length),b=at({ticks:C,tickLabelStyle:S.axisStyles.y.left.tickLabel,valueFormatter:c,tickLength:S.axisStyles.y.left.tickLength});return A.jsxs("div",{className:"tw-flex tw-flex-col tw-gap-6",children:[!n&&i===fe&&A.jsx(ne,{names:r.map(P=>P.name),style:"line"}),A.jsxs(nt,{theme:S,xScale:{type:"time"},yScale:{type:"linear",domain:h},height:t,width:e,margin:b,children:[A.jsx(Ae,{tickValues:C}),A.jsx(be,{series:r}),A.jsx(Ke,{linearScaleTicks:C,valueFormatter:c,locale:o,series:r}),s&&A.jsx(Ie,{...s}),A.jsx(ot,{crossHairStyle:"line",hideGlyphs:!1,colorAccessor:P=>Ye(P,r),missingValueLabel:a,childSumLabel:u,valueFormatter:c,locale:o,stackingGlyphs:!0})]}),!n&&i==="bottom"&&A.jsx(ne,{names:r.map(P=>P.name),style:"line"})]})};Q.__docgenInfo={description:"",methods:[],displayName:"AreaStackChart",props:{series:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    dataPoints: AreaStackChartDataPoint[];
    name: string;
}`,signature:{properties:[{key:"dataPoints",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
    timestamp: Date;
    value: number | null;
    description?: string;
}`,signature:{properties:[{key:"timestamp",value:{name:"Date",required:!0}},{key:"value",value:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}],required:!0}},{key:"description",value:{name:"string",required:!1}}]}}],raw:"AreaStackChartDataPoint[]",required:!0}},{key:"name",value:{name:"string",required:!0}}]}}],raw:"AreaStackChartSeries[]"},description:""},height:{required:!0,tsType:{name:"number"},description:""},width:{required:!1,tsType:{name:"number"},description:""},missingValueLabel:{required:!1,tsType:{name:"string"},description:""},childSumLabel:{required:!1,tsType:{name:"string"},description:""},locale:{required:!1,tsType:{name:"string"},description:""},hideLegend:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},legendPosition:{required:!1,tsType:{name:"union",raw:"'top' | 'bottom'",elements:[{name:"literal",value:"'top'"},{name:"literal",value:"'bottom'"}]},description:"",defaultValue:{value:"'top'",computed:!1}},markLine:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    name: string;
    value: number;
}`,signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"value",value:{name:"number",required:!0}}]}},description:""},valueFormatter:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: number) => string",signature:{arguments:[{type:{name:"number"},name:"value"}],return:{name:"string"}}},description:""},domain:{required:!1,tsType:{name:"union",raw:"'storage' | 'count'",elements:[{name:"literal",value:"'storage'"},{name:"literal",value:"'count'"}]},description:"",defaultValue:{value:"'storage'",computed:!1}}}};const Qt={title:"Charts/Area Stack Chart",component:Q,parameters:{status:{type:"released"}},argTypes:{series:{name:"series",type:{name:"other",value:"AreaStackChartSeries[]",required:!0},description:"An array of up to three series to be displayed in the chart."},height:{name:"height",type:{name:"number",required:!0},description:"The height of the chart in pixels."},width:{name:"width",type:{name:"number",required:!1},description:"The width of the chart in pixels. If not provided, the chart will adjust its width to the container"},missingValueLabel:{name:"missingValueLabel",type:{name:"string",required:!1},description:'The label to be displayed for missing values. E.g. "No data".',defaultValue:"-",table:{type:{summary:"string"},defaultValue:{summary:"-"}}},locale:{name:"locale",type:{name:"string",required:!1},description:"The locale to be used for formatting the date axis labels.",table:{type:{summary:"string"},defaultValue:{summary:"Browser locale"}}},hideLegend:{name:"hideLegend",type:{name:"boolean",required:!1},description:"Hides the legend if set to true.",table:{type:{summary:"boolean"},defaultValue:{summary:"false"}}},legendPosition:{name:"legendPosition",type:{name:"other",value:"top | bottom",required:!1},description:"Controls whether the legend is placed above or below the chart.",table:{type:{summary:"top | bottom"},defaultValue:{summary:"top"}}},markLine:{name:"markLine",type:{name:"other",value:"MarkLineProps",required:!1},description:"Creates a horizontal line on the chart, marking a specific value."},valueFormatter:{name:"valueFormatter",type:{name:"other",value:"(value: number) => string",required:!1},description:"An optional function to format the displayed values (for example for adding units)."}}},_t=1024,Ft=(e,t=0)=>{const r=parseInt((e==null?void 0:e.toString())||"0",10),a=Math.floor((r.toString().length-1)/3),o=["B","KB","MB","GB","TB","PB","EB"][a];return t===0?`${Math.ceil(parseFloat((r/1024**a).toFixed()))} ${o}`:`${(r/_t**a).toFixed(t)} ${o}`},Bt=1024*1024,Mt=e=>Ft(e*Bt,1),we=e=>A.jsx(Q,{...e}),Vt=e=>`${e.toFixed(2)}°F`,Te=(()=>{const e=[],t=[],r=[];for(const a of Re)e.push({value:parseInt(a.Austin,10),timestamp:new Date(a.date)}),t.push({value:parseInt(a["New York"],10),timestamp:new Date(a.date)}),r.push({value:parseInt(a["San Francisco"],10),timestamp:new Date(a.date)});return[{name:"Austin",dataPoints:e},{name:"New York",dataPoints:t},{name:"San Francisco",dataPoints:r}]})(),K=we.bind({});K.args={series:Te,width:1e3,height:500,valueFormatter:Mt,childSumLabel:"Total",markLine:{name:"Freezing",value:1500},domain:"storage"};const I=we.bind({});I.args={series:Te,width:1e3,height:500,valueFormatter:Vt,childSumLabel:"Total"};var pe,ye,he;K.parameters={...K.parameters,docs:{...(pe=K.parameters)==null?void 0:pe.docs,source:{originalSource:"args => <AreaStackChart {...args} />",...(he=(ye=K.parameters)==null?void 0:ye.docs)==null?void 0:he.source}}};var ve,ge,ke;I.parameters={...I.parameters,docs:{...(ve=I.parameters)==null?void 0:ve.docs,source:{originalSource:"args => <AreaStackChart {...args} />",...(ke=(ge=I.parameters)==null?void 0:ge.docs)==null?void 0:ke.source}}};const er=["AreaStackedChartStorage","AreaStackedChart"];export{I as AreaStackedChart,K as AreaStackedChartStorage,er as __namedExportsOrder,Qt as default};
